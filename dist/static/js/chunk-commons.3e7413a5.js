(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"05cc":function(e,t,r){"use strict";r("073b")},"073b":function(e,t,r){},"4f59":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",[r("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.crud.toQuery}},[e._v("查询")]),e._v(" "),e.crud.optShow.reset?r("el-button",{staticClass:"filter-item",on:{click:function(t){return e.crud.resetQuery()}}},[e._v("重置")]):e._e()],1)},i=[],a=r("c6db"),o={mixins:[Object(a["a"])()],props:{itemClass:{type:String,required:!1,default:""}}},s=o,u=r("2877"),c=Object(u["a"])(s,n,i,!1,null,null,null);t["a"]=c.exports},8414:function(e,t,r){"use strict";var n,i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-button",{attrs:{loading:2===e.crud.status.cu,disabled:e.disabledEdit,size:"mini"},on:{click:function(t){return e.crud.toEdit(e.data)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{slot:"reference",disabled:e.disabledDle,type:"danger",size:"mini"},on:{click:function(t){e.deleteVisible=!0}},slot:"reference"},[e._v("删除")]),e._v(" "),r("div",{staticStyle:{display:"inline-block"}},[r("el-dialog",{attrs:{title:"确认删除",visible:e.deleteVisible,width:"400px","append-to-body":!0,"show-close":!1,"destroy-on-close":!0},on:{"update:visible":function(t){e.deleteVisible=t}}},[r("span",[e._v("确认删除选中项？")]),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.crud.doDelete(e.data)}}},[e._v("确 定")]),e._v(" "),r("el-button",{on:{click:e.doCancel}},[e._v("取 消")])],1)])],1)],1)},a=[],o=r("ade3"),s=r("c6db"),u={mixins:[Object(s["a"])()],props:{data:{type:Object,required:!0},disabledEdit:{type:Boolean,default:!1},disabledDle:{type:Boolean,default:!1},msg:{type:String,default:"确定删除本条数据吗？"}},data:function(){return{deleteVisible:!1,pop:!1}},methods:(n={doCancel:function(){this.pop=!1,this.deleteVisible=!1,this.crud.cancelDelete(this.data)},toDelete:function(){this.pop=!0}},Object(o["a"])(n,s["b"].HOOK.afterDelete,(function(e,t){t===this.data&&(this.pop=!1,this.deleteVisible=!1)})),Object(o["a"])(n,"onPopoverShow",(function(){var e=this;setTimeout((function(){document.addEventListener("click",e.handleDocumentClick)}),0)})),Object(o["a"])(n,"onPopoverHide",(function(){document.removeEventListener("click",this.handleDocumentClick)})),Object(o["a"])(n,"handleDocumentClick",(function(e){this.pop=!1,this.deleteVisible=!1})),n)},c=u,d=r("2877"),l=Object(d["a"])(c,i,a,!1,null,null,null);t["a"]=l.exports},ab00:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"crud-opts"},[r("span",{staticClass:"crud-opts-left"},[e._t("left"),e._v(" "),e.crud.optShow.add?r("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.crud.toAdd}},[e._v("\n      添加\n    ")]):e._e(),e._v(" "),e.crud.optShow.del?r("el-button",{staticClass:"filter-item",attrs:{slot:"reference",type:"danger",size:"small",loading:e.crud.delAllLoading,disabled:0===e.crud.selections.length},on:{click:function(t){return e.toDelete(e.crud.selections)}},slot:"reference"},[e._v("\n      删除\n    ")]):e._e(),e._v(" "),e._t("right")],2)])},i=[],a=(r("7514"),r("ac6a"),r("c6db"));function o(e,t){var r=Object.assign([],t),n=-1;return e.forEach((function(e){var t=r.indexOf(e);-1===t?(n+=1,r.splice(n,0,e)):n=t})),r}var s={mixins:[Object(a["a"])()],props:{hiddenColumns:{type:Array,default:function(){return[]}},ignoreColumns:{type:Array,default:function(){return[]}}},data:function(){return{tableColumns:[],allColumnsSelected:!0,allColumnsSelectedIndeterminate:!1,tableUnwatcher:null,ignoreNextTableColumnsChange:!1}},watch:{"crud.props.table":function(){var e=this;this.updateTableColumns(),this.tableColumns.forEach((function(t){-1!==e.hiddenColumns.indexOf(t.property)&&(t.visible=!1,e.updateColumnVisible(t))}))},"crud.props.table.store.states.columns":function(){this.updateTableColumns()}},created:function(){this.crud.updateProp("searchToggle",!0)},methods:{updateTableColumns:function(){var e=this,t=this.crud.getTable();if(t){var r=null,n=function(t){return t&&"default"===t.type&&t.property&&-1===e.ignoreColumns.indexOf(t.property)},i=t.columns.filter(n);if(this.ignoreNextTableColumnsChange)this.ignoreNextTableColumnsChange=!1;else{this.ignoreNextTableColumnsChange=!1;var a=[],s=t.$children.map((function(e){return e.columnConfig})).filter(n);r=o(s,i),r.forEach((function(e){var t={property:e.property,label:e.label,visible:-1!==i.indexOf(e)};a.push(t)})),this.tableColumns=a}}else this.tableColumns=[]},toDelete:function(e){var t=this;this.$confirm("确认删除选中的".concat(e.length,"条数据?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.crud.delAllLoading=!0,t.crud.doDelete(e)})).catch((function(){}))},handleCheckAllChange:function(e){var t=this;!1!==e?(this.tableColumns.forEach((function(e){e.visible||(e.visible=!0,t.updateColumnVisible(e))})),this.allColumnsSelected=e,this.allColumnsSelectedIndeterminate=!1):this.allColumnsSelected=!0},handleCheckedTableColumnsChange:function(e){var t=0,r=0;if(this.tableColumns.forEach((function(e){++t,r+=e.visible?1:0})),0===r)return this.crud.notify("请至少选择一列",a["b"].NOTIFICATION_TYPE.WARNING),void this.$nextTick((function(){e.visible=!0}));this.allColumnsSelected=r===t,this.allColumnsSelectedIndeterminate=r!==t&&0!==r,this.updateColumnVisible(e)},updateColumnVisible:function(e){var t=this.crud.props.table,r=t.$children.find((function(t){return t.prop===e.property})),n=r.columnConfig;if(e.visible){var i=this.tableColumns.indexOf(e);r.owner.store.commit("insertColumn",n,i+1,null)}else r.owner.store.commit("removeColumn",n,null);this.ignoreNextTableColumnsChange=!0},toggleSearch:function(){this.crud.props.searchToggle=!this.crud.props.searchToggle}}},u=s,c=(r("05cc"),r("2877")),d=Object(c["a"])(u,n,i,!1,null,null,null);t["a"]=d.exports},c6db:function(e,t,r){"use strict";r.d(t,"f",(function(){return f})),r.d(t,"d",(function(){return h})),r.d(t,"c",(function(){return p})),r.d(t,"e",(function(){return g})),r.d(t,"a",(function(){return m}));r("5df3"),r("4f7f"),r("0d6d"),r("7514");var n=r("53ca"),i=(r("55dd"),r("456d"),r("ac6a"),r("5530")),a=r("316f"),o=r("6ce0"),s=r("2b0e");function u(e){var t={tag:"default",idField:"id",title:"",url:"",data:[],selections:[],query:{},params:{},form:{},defaultForm:function(){},sort:["id,desc"],time:50,crudMethod:{add:function(e){},del:function(e){},edit:function(e){},get:function(e){}},optShow:{add:!0,edit:!0,del:!0,download:!0,reset:!0},props:{},queryOnPresenterCreated:!0,debug:!1};e=d(t,e);var r=Object(i["a"])(Object(i["a"])({},e),{},{dataStatus:{},status:{add:u.STATUS.NORMAL,edit:u.STATUS.NORMAL,get cu(){if(this.add===u.STATUS.NORMAL&&this.edit===u.STATUS.NORMAL)return u.STATUS.NORMAL;if(this.add===u.STATUS.PREPARED||this.edit===u.STATUS.PREPARED)return u.STATUS.PREPARED;if(this.add===u.STATUS.PROCESSING||this.edit===u.STATUS.PROCESSING)return u.STATUS.PROCESSING;throw new Error("wrong crud's cu status")},get title(){return this.add>u.STATUS.NORMAL?"新增".concat(f.title):this.edit>u.STATUS.NORMAL?"编辑".concat(f.title):f.title}},msg:{submit:"提交成功",add:"新增成功",edit:"编辑成功",del:"删除成功"},page:{page:0,size:5,total:0},loading:!1,downloadLoading:!1,delAllLoading:!1}),l={submitSuccessNotify:function(){f.notify(f.msg.submit,u.NOTIFICATION_TYPE.SUCCESS)},addSuccessNotify:function(){f.notify(f.msg.add,u.NOTIFICATION_TYPE.SUCCESS)},editSuccessNotify:function(){f.notify(f.msg.edit,u.NOTIFICATION_TYPE.SUCCESS)},delSuccessNotify:function(){f.notify(f.msg.del,u.NOTIFICATION_TYPE.SUCCESS)},toQuery:function(){f.page.page=1,f.refresh()},refresh:function(){if(c(f,u.HOOK.beforeRefresh))return new Promise((function(e,t){f.loading=!0,Object(a["b"])(f.url,f.getQueryParams()).then((function(t){var r=f.getTable();r&&r.lazy&&(r.store.states.treeData={},r.store.states.lazyTreeNodeMap={}),f.page.total=t.totalElements,f.data=t.content,console.log("menu"+JSON.stringify(t)),f.resetDataStatus(),setTimeout((function(){f.loading=!1,c(f,u.HOOK.afterRefresh)}),f.time),e(t)})).catch((function(e){f.loading=!1,t(e)}))}))},toAdd:function(){f.resetForm(),c(f,u.HOOK.beforeToAdd,f.form)&&c(f,u.HOOK.beforeToCU,f.form)&&(f.status.add=u.STATUS.PREPARED,c(f,u.HOOK.afterToAdd,f.form),c(f,u.HOOK.afterToCU,f.form))},toEdit:function(e){f.resetForm(JSON.parse(JSON.stringify(e))),c(f,u.HOOK.beforeToEdit,f.form)&&c(f,u.HOOK.beforeToCU,f.form)&&(f.status.edit=u.STATUS.PREPARED,f.getDataStatus(f.getDataId(e)).edit=u.STATUS.PREPARED,c(f,u.HOOK.afterToEdit,f.form),c(f,u.HOOK.afterToCU,f.form))},toDelete:function(e){f.getDataStatus(f.getDataId(e)).delete=u.STATUS.PREPARED},cancelDelete:function(e){c(f,u.HOOK.beforeDeleteCancel,e)&&(f.getDataStatus(f.getDataId(e)).delete=u.STATUS.NORMAL,c(f,u.HOOK.afterDeleteCancel,e))},cancelCU:function(){var e=f.status.add,t=f.status.edit;if(e===u.STATUS.PREPARED){if(!c(f,u.HOOK.beforeAddCancel,f.form))return;f.status.add=u.STATUS.NORMAL}if(t===u.STATUS.PREPARED){if(!c(f,u.HOOK.beforeEditCancel,f.form))return;f.status.edit=u.STATUS.NORMAL,f.getDataStatus(f.getDataId(f.form)).edit=u.STATUS.NORMAL}f.resetForm(),e===u.STATUS.PREPARED&&c(f,u.HOOK.afterAddCancel,f.form),t===u.STATUS.PREPARED&&c(f,u.HOOK.afterEditCancel,f.form),f.findVM("form").$refs["form"]&&f.findVM("form").$refs["form"].clearValidate()},submitCU:function(){c(f,u.HOOK.beforeValidateCU)&&f.findVM("form").$refs["form"].validate((function(e){e&&c(f,u.HOOK.afterValidateCU)&&(f.status.add===u.STATUS.PREPARED?f.doAdd():f.status.edit===u.STATUS.PREPARED&&f.doEdit())}))},doAdd:function(){c(f,u.HOOK.beforeSubmit)&&(f.status.add=u.STATUS.PROCESSING,f.crudMethod.add(f.form).then((function(){f.status.add=u.STATUS.NORMAL,f.resetForm(),f.addSuccessNotify(),c(f,u.HOOK.afterSubmit),f.toQuery()})).catch((function(){f.status.add=u.STATUS.PREPARED,c(f,u.HOOK.afterAddError)})))},doEdit:function(){c(f,u.HOOK.beforeSubmit)&&(f.status.edit=u.STATUS.PROCESSING,f.crudMethod.edit(f.form).then((function(){f.status.edit=u.STATUS.NORMAL,f.getDataStatus(f.getDataId(f.form)).edit=u.STATUS.NORMAL,f.editSuccessNotify(),f.resetForm(),c(f,u.HOOK.afterSubmit),f.refresh()})).catch((function(){f.status.edit=u.STATUS.PREPARED,c(f,u.HOOK.afterEditError)})))},doDelete:function(e){var t,r=this,n=!1,i=[];if(e instanceof Array?(n=!0,e.forEach((function(e){i.push(r.getDataId(e))}))):(i.push(this.getDataId(e)),t=f.getDataStatus(this.getDataId(e))),c(f,u.HOOK.beforeDelete,e))return n||(t.delete=u.STATUS.PROCESSING),f.crudMethod.del(i).then((function(){n?f.delAllLoading=!1:t.delete=u.STATUS.PREPARED,f.dleChangePage(1),f.delSuccessNotify(),c(f,u.HOOK.afterDelete,e),f.refresh()})).catch((function(){n?f.delAllLoading=!1:t.delete=u.STATUS.PREPARED}))},doExport:function(){f.downloadLoading=!0,Object(a["a"])(f.url+"/download",f.getQueryParams()).then((function(e){Object(o["a"])(e,f.title+"数据","xlsx"),f.downloadLoading=!1})).catch((function(){f.downloadLoading=!1}))},getQueryParams:function(){return 0!==Object.keys(f.query).length&&Object.keys(f.query).forEach((function(e){null!==f.query[e]&&""!==f.query[e]||(f.query[e]=void 0)})),0!==Object.keys(f.params).length&&Object.keys(f.params).forEach((function(e){null!==f.params[e]&&""!==f.params[e]||(f.params[e]=void 0)})),Object(i["a"])(Object(i["a"])({page:f.page.page-1,size:f.page.size,sort:f.sort},f.query),f.params)},pageChangeHandler:function(e){f.page.page=e,f.refresh()},sizeChangeHandler:function(e){f.page.size=e,f.page.page=1,f.refresh()},dleChangePage:function(e){f.data.length===e&&1!==f.page.page&&(f.page.page-=1)},selectionChangeHandler:function(e){f.selections=e},resetQuery:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=JSON.parse(JSON.stringify(f.defaultQuery)),r=f.query;Object.keys(r).forEach((function(e){r[e]=t[e]})),this.params={},e&&f.toQuery()},resetForm:function(e){var t=e||("object"===Object(n["a"])(f.defaultForm)?JSON.parse(JSON.stringify(f.defaultForm)):f.defaultForm.apply(f.findVM("form"))),r=f.form;for(var i in t)r.hasOwnProperty(i)?r[i]=t[i]:s["default"].set(r,i,t[i])},resetDataStatus:function(){var e={};function t(r){r.forEach((function(r){e[f.getDataId(r)]={delete:0,edit:0},r.children&&t(r.children)}))}t(f.data),f.dataStatus=e},getDataStatus:function(e){return f.dataStatus[e]},selectAllChange:function(e){e&&e.length===f.data.length?e.forEach((function(t){f.selectChange(e,t)})):f.getTable().clearSelection()},selectChange:function(e,t){e.find((function(e){return f.getDataId(e)===f.getDataId(t)}))?t.children&&t.children.forEach((function(t){f.getTable().toggleRowSelection(t,!0),e.push(t),t.children&&f.selectChange(e,t)})):f.toggleRowSelection(e,t)},toggleRowSelection:function(e,t){t.children&&t.children.forEach((function(t){f.getTable().toggleRowSelection(t,!1),t.children&&f.toggleRowSelection(e,t)}))},findVM:function(e){return f.vms.find((function(t){return t&&t.type===e})).vm},notify:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.NOTIFICATION_TYPE.INFO;f.vms[0].vm.$notify({title:e,type:t,duration:2500})},updateProp:function(e,t){s["default"].set(f.props,e,t)},getDataId:function(e){return e[this.idField]},getTable:function(){return this.findVM("presenter").$refs.table},attchTable:function(){var e=this.getTable();this.updateProp("table",e);var t=this;e.$on("expand-change",(function(r,n){if(n){var i=e.store.states.lazyTreeNodeMap,a=i[r.id];r.children=a,a.forEach((function(e){var r=f.getDataId(e);void 0===t.dataStatus[r]&&(t.dataStatus[r]={delete:0,edit:0})}))}}))}},f=Object.assign({},r);return s["default"].observable(f),Object.assign(f,l),Object.assign(f,{defaultQuery:JSON.parse(JSON.stringify(r.query)),vms:Array(4),registerVM:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n={type:e,vm:t};r<0?this.vms.push(n):r<4?this.vms[r]=n:(this.vms.length=Math.max(this.vms.length,r),this.vms.splice(r,1,n))},unregisterVM:function(e,t){for(var r=this.vms.length-1;r>=0;r--)if(void 0!==this.vms[r]&&this.vms[r].type===e&&this.vms[r].vm===t){r<4?this.vms[r]=void 0:this.vms.splice(r,1);break}}}),Object.freeze(f),f}function c(e,t){e.debug&&console.log("callVmHook: "+t);for(var r=e.tag?t+"$"+e.tag:null,n=!0,i=[e],a=2;a<arguments.length;++a)i.push(arguments[a]);var o=new Set;return e.vms.forEach((function(e){return e&&o.add(e.vm)})),o.forEach((function(e){e[t]&&(n=!1!==e[t].apply(e,i)&&n),r&&e[r]&&(n=!1!==e[r].apply(e,i)&&n)})),n}function d(e,t){var r=Object(i["a"])({},e);for(var n in e)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}function l(e,t){if(t=t||e.$attrs["crud-tag"]||"default",e.$crud){var r=e.$crud[t];if(r)return r}return e.$parent?l(e.$parent,t):void 0}function f(e){return e&&console.warn("[CRUD warn]: please use $options.cruds() { return CRUD(...) or [CRUD(...), ...] }"),{data:function(){return{crud:this.crud}},beforeCreate:function(){var t=this;this.$crud=this.$crud||{};var r=this.$options.cruds instanceof Function?this.$options.cruds():e;r instanceof Array||(r=[r]),r.forEach((function(e){t.$crud[e.tag]&&console.error("[CRUD error]: crud with tag ["+e.tag+" is already exist"),t.$crud[e.tag]=e,e.registerVM("presenter",t,0)})),this.crud=this.$crud["defalut"]||r[0]},methods:{parseTime:o["c"]},created:function(){for(var e in this.$crud)this.$crud[e].queryOnPresenterCreated&&this.$crud[e].toQuery()},destroyed:function(){for(var e in this.$crud)this.$crud[e].unregisterVM("presenter",this)},mounted:function(){void 0!==this.$refs.table&&this.crud.attchTable()}}}function h(){return{data:function(){return{crud:this.crud,query:this.crud.query}},beforeCreate:function(){this.crud=l(this),this.crud.registerVM("header",this,1)},destroyed:function(){this.crud.unregisterVM("header",this)}}}function g(){return{data:function(){return{crud:this.crud,page:this.crud.page}},beforeCreate:function(){this.crud=l(this),this.crud.registerVM("pagination",this,2)},destroyed:function(){this.crud.unregisterVM("pagination",this)}}}function p(e){return{data:function(){return{crud:this.crud,form:this.crud.form}},beforeCreate:function(){this.crud=l(this),this.crud.registerVM("form",this,3)},created:function(){this.crud.defaultForm=e,this.crud.resetForm()},destroyed:function(){this.crud.unregisterVM("form",this)}}}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={type:void 0};return e=d(t,e),{data:function(){return{crud:this.crud}},beforeCreate:function(){this.crud=l(this),this.crud.registerVM(e.type,this)},destroyed:function(){this.crud.unregisterVM(e.type,this)}}}u.HOOK={beforeRefresh:"beforeCrudRefresh",afterRefresh:"afterCrudRefresh",beforeDelete:"beforeCrudDelete",afterDelete:"afterCrudDelete",beforeDeleteCancel:"beforeCrudDeleteCancel",afterDeleteCancel:"afterCrudDeleteCancel",beforeToAdd:"beforeCrudToAdd",afterToAdd:"afterCrudToAdd",beforeToEdit:"beforeCrudToEdit",afterToEdit:"afterCrudToEdit",beforeToCU:"beforeCrudToCU",afterToCU:"afterCrudToCU",beforeValidateCU:"beforeCrudValidateCU",afterValidateCU:"afterCrudValidateCU",beforeAddCancel:"beforeCrudAddCancel",afterAddCancel:"afterCrudAddCancel",beforeEditCancel:"beforeCrudEditCancel",afterEditCancel:"afterCrudEditCancel",beforeSubmit:"beforeCrudSubmitCU",afterSubmit:"afterCrudSubmitCU",afterAddError:"afterCrudAddError",afterEditError:"afterCrudEditError"},u.STATUS={NORMAL:0,PREPARED:1,PROCESSING:2},u.NOTIFICATION_TYPE={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},t["b"]=u},e396:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{background:"","pager-count":5,"current-page":e.currentPage,"page-sizes":e.pagesizes,"page-size":e.pagesize,layout:e.layout[e.type],total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})},i=[],a=(r("c5f6"),{name:"Pagination",props:{message:Number,type:Number},data:function(){return{pagesizes:[5,10,15,20],pagesize:5,currentPage:1,layout:["total, sizes, prev, pager, next, jumper","total, sizes, prev, pager, next"],total:this.message}},watch:{message:function(e,t){this.total=e,(this.currentPage-1)*this.pagesize>=this.total&&this.currentPage>1&&(this.currentPage-=1),console.log("页码",this.currentPage),this.$emit("func",[this.pagesize,this.currentPage])}},methods:{handleSizeChange:function(e){console.log("每页 ".concat(e," 条")),console.log(this.pagesize,this.total),this.pagesize=e,this.currentPage=1,this.$emit("func",[this.pagesize,this.currentPage])},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),console.log(this.currentPage),this.currentPage=e,this.$emit("func",[this.pagesize,this.currentPage])}}}),o=a,s=r("2877"),u=Object(s["a"])(o,n,i,!1,null,null,null);t["a"]=u.exports}}]);